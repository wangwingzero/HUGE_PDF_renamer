# PDF重命名工具 高速模式功能说明

## 🚀 高速模式简介

高速模式是PDF重命名工具的新增功能，专为大批量文件处理场景设计。它采用极简的提取策略，大幅提升处理速度。

## ⚡ 功能特点

### 1. 极速处理
- **只提取第一页内容**：跳过多页分析，节省大量时间
- **仅识别最大字体**：直接定位标题文本，避免复杂分析
- **5秒快速超时**：无法识别则立即跳过，不浪费时间
- **无回退策略**：单一策略执行，避免多重尝试

### 2. 智能优化
- **限制处理元素**：只处理前50个文本元素
- **限制字符数量**：只分析前300个字符
- **简化匹配算法**：使用宽松匹配条件减少计算量
- **快速质量检查**：3-120字符长度范围，过滤无效结果

### 3. 适用场景
- ✅ **大批量文件处理**（100+个文件）
- ✅ **标准格式PDF**（有明确标题）
- ✅ **对准确率要求不高**的快速分类
- ✅ **时间紧迫**的批处理任务

## 📊 性能对比

| 策略模式 | 处理速度 | 准确率 | 超时时间 | 适用场景 |
|---------|---------|--------|---------|---------|
| **高速模式** | ⭐⭐⭐⭐⭐ | ⭐⭐⭐ | 5秒 | 大批量快速处理 |
| 字体大小 | ⭐⭐⭐ | ⭐⭐⭐⭐ | 30秒 | 一般文档 |
| 综合策略 | ⭐⭐ | ⭐⭐⭐⭐⭐ | 30秒 | 高质量要求 |
| 位置策略 | ⭐⭐⭐ | ⭐⭐ | 30秒 | 特殊格式 |

## 🎯 使用方法

### 1. 选择高速模式
在主界面的"提取策略"下拉框中选择 `fast_mode`

### 2. 界面提示
选择高速模式后，会显示提示信息：
```
💡 高速模式：仅提取第一页最大字体，无法识别则跳过（适合大批量处理）
```

### 3. 配置建议
- ✅ **开启并行处理**：充分利用多核性能
- ✅ **关闭自动备份**：减少I/O操作（可选）
- ⚠️ **注意文件筛选**：预先过滤复杂格式的PDF

## ⚠️ 注意事项

### 1. 适用文件类型
- ✅ **标准学术论文**：有明确标题
- ✅ **企业报告**：格式规范的文档
- ✅ **产品手册**：标题字体突出
- ❌ **扫描PDF**：无文本层的图像PDF
- ❌ **复杂排版**：多栏布局、艺术排版

### 2. 处理结果
- **成功提取**：显示提取的标题文本
- **直接跳过**：无法识别时不进行重命名
- **错误日志**：异常情况记录在日志中（Debug级别）

### 3. 失败处理
高速模式下，如果文件无法处理：
- 📝 记录失败原因
- ⏭️ 立即跳过，继续下一个
- 📊 在最终统计中显示跳过数量

## 🔧 技术细节

### 1. 核心算法
```python
# 高速模式核心逻辑
1. 提取第一页前50个文本元素
2. 分析前300个字符的字体信息
3. 找到最大字体尺寸的文本
4. 简单合并同字体大小的文本
5. 快速质量检查（3-120字符）
6. 返回结果或跳过
```

### 2. 超时机制
- **全局超时**：10秒（vs 普通模式60秒）
- **策略超时**：5秒（vs 普通模式30秒）
- **立即跳过**：超时后不重试

### 3. 性能优化
- **减少字符匹配计算**
- **跳过复杂排序操作**
- **避免多策略回退**
- **最小化错误处理**

## 📈 使用建议

### 1. 预处理
- 将PDF文件按类型分组
- 优先处理标准格式文档
- 预估处理时间和成功率

### 2. 批处理策略
- 大文件（>100MB）提前筛选
- 扫描版PDF单独处理
- 重要文件使用普通模式

### 3. 后处理
- 检查跳过的文件列表
- 对失败文件使用其他策略
- 验证重命名结果

## 🧪 测试工具

运行测试脚本验证功能：
```bash
python test_fast_mode.py
```

测试脚本会比较不同策略的：
- ⏱️ 处理速度
- ✅ 成功率
- 📝 提取质量

---

**💡 小贴士**：高速模式适合"先快速分类，再精细处理"的工作流程。对于重要文档，建议先用高速模式批量处理，然后对失败的文件使用综合策略进行二次处理。 