# 虎大王PDF重命名工具 v2.0 打包指南

## 🚀 一键打包（推荐）

### 方法1：使用批处理文件（最简单）
1. 双击 `一键打包.bat` 文件
2. 按照提示等待打包完成
3. 在 `dist/虎大王PDF重命名工具_v2.0/` 目录中找到可执行文件

### 方法2：使用Python脚本
```bash
python quick_build.py
```

## 🔧 手动打包（专业用户）

### 方法3：使用完整构建脚本
```bash
python build_v2_exe.py
```
这个脚本提供更多功能：
- 自动创建版本信息
- 生成应用程序清单
- 创建便携版ZIP
- 生成安装包配置
- 构建报告

### 方法4：直接使用PyInstaller
```bash
pyinstaller pdf_renamer_v2.py ^
    --name="虎大王PDF重命名工具_v2.0" ^
    --onedir ^
    --windowed ^
    --noconfirm ^
    --clean ^
    --icon=pdf_renamer.ico ^
    --hidden-import=sv_ttk ^
    --hidden-import=pdfplumber ^
    --collect-all=pdfplumber ^
    --collect-all=sv_ttk ^
    --optimize=2
```

## 📋 准备工作

### 系统要求
- Windows 10 或更高版本
- Python 3.8 或更高版本
- 至少 1GB 可用磁盘空间

### 必需文件
确保项目目录中包含以下文件：
- ✅ `pdf_renamer_v2.py` - 主程序文件
- ✅ `config.py` - 配置管理模块
- ✅ `text_extractor.py` - 文本提取模块
- ✅ `file_processor.py` - 文件处理模块
- ✅ `utils.py` - 工具函数模块
- ✅ `pdf_renamer.ico` - 应用程序图标
- ✅ `requirements.txt` - 依赖包列表
- ✅ `LICENSE` - 许可证文件

### 安装依赖
```bash
pip install -r requirements.txt
```

如果 requirements.txt 不存在，手动安装核心依赖：
```bash
pip install pyinstaller pdfplumber sv_ttk pillow
```

## 📦 打包输出说明

### 文件结构
```
dist/
└── 虎大王PDF重命名工具_v2.0/
    ├── 虎大王PDF重命名工具_v2.0.exe  # 主程序
    ├── _internal/                      # 依赖库文件
    ├── logs/                          # 日志目录（自动创建）
    ├── README.txt                     # 使用说明
    ├── LICENSE                        # 许可证
    └── 其他依赖文件...
```

### 文件大小预期
- 可执行文件：约 5-15 MB
- 整个目录：约 100-200 MB（包含所有依赖）

## 🎯 分发方式

### 1. 便携版分发（推荐）
- 将整个 `dist/虎大王PDF重命名工具_v2.0/` 文件夹打包为ZIP
- 用户解压后直接运行 `.exe` 文件
- 无需安装，即开即用

### 2. 安装包分发（专业）
使用 Inno Setup 创建安装包：
1. 下载并安装 [Inno Setup](https://jrsoftware.org/isinfo.php)
2. 打开 `setup_v2.iss` 文件
3. 点击 Build → Compile 生成安装包
4. 在 `Output/` 目录中找到生成的安装程序

## 🔍 常见问题

### Q: 打包失败，提示缺少模块
**A:** 检查是否安装了所有依赖：
```bash
pip install pdfplumber sv_ttk pillow pathlib
```

### Q: 生成的exe文件很大
**A:** 这是正常的，因为需要包含Python运行环境和所有依赖库。

### Q: 在其他电脑上运行出错
**A:** 确保：
1. 目标电脑是64位Windows系统
2. 包含完整的 `dist` 目录
3. 有足够的磁盘空间和内存

### Q: 程序启动慢
**A:** 首次启动会较慢（10-30秒），这是正常现象。后续启动会更快。

### Q: 杀毒软件误报
**A:** 
1. 将程序添加到杀毒软件白名单
2. 使用数字签名（需要证书）
3. 联系杀毒软件厂商报告误报

## 📊 优化建议

### 减小文件大小
1. 使用 `--exclude-module` 排除不需要的模块
2. 考虑使用 `--onefile` 打包为单文件（但启动会更慢）
3. 压缩输出目录

### 提高启动速度
1. 使用 `--optimize=2` 优化字节码
2. 预编译常用模块
3. 减少导入的模块数量

### 提高兼容性
1. 在虚拟机中测试
2. 在不同版本的Windows上测试
3. 使用静态链接库

## 🛠️ 高级选项

### 自定义打包参数
编辑 `build_v2_exe.py` 中的 `pyinstaller_args` 列表来自定义打包选项。

### 添加数字签名
```bash
signtool sign /f "certificate.pfx" /p "password" /t http://timestamp.digicert.com "虎大王PDF重命名工具_v2.0.exe"
```

### 创建便携启动器
```bash
# 创建一个批处理文件来设置环境变量
@echo off
cd /d "%~dp0"
set PORTABLE_MODE=1
虎大王PDF重命名工具_v2.0.exe %*
```

## 📞 技术支持

如果遇到问题：
1. 查看 `logs/` 目录中的日志文件
2. 检查 `build_report.json` 构建报告
3. 使用 `--debug` 参数获取详细信息

## 📝 版本历史

- v2.0.0 - 重构版本，支持多种提取策略
- v1.0.0 - 初始版本

---

*构建脚本基于最佳实践设计，确保生成高质量、可靠的可执行文件。* 